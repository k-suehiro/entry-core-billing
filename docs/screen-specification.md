# Entry Core Billing システム 画面定義書

## 1. システム概要

### 1.1 システム名
Entry Core Billing - 伝票管理台帳

### 1.2 システム目的
売上伝票と仕入伝票の管理を行う業務システム

### 1.3 技術スタック
- フロントエンド: React + TypeScript + Tailwind CSS
- バックエンド: Supabase
- ルーティング: React Router DOM
- チャート: Recharts
- アイコン: Lucide React

---

## 2. 画面構成

### 2.1 画面一覧
1. 売上伝票一覧画面 (`/sales`)
2. 売上伝票登録・編集画面 (`/sales/new`, `/sales/:id`)
3. 仕入伝票一覧画面 (`/purchases`)
4. 仕入伝票登録・編集画面 (`/purchases/new`, `/purchases/:id`)

---

## 3. 共通レイアウト

### 3.1 ヘッダーナビゲーション
- **位置**: 画面上部固定
- **背景色**: グラデーション（グレー900→グレー800）
- **高さ**: 96px (h-24)

#### 3.1.1 左側エリア
- **ロゴ**: ScrollTextアイコン + システム名
  - アイコンサイズ: 40px × 40px
  - システム名: "Entry Core Billing"（白色、24px、太字）
  - サブタイトル: "伝票管理台帳"（グレー400、16px）

#### 3.1.2 中央エリア（ナビゲーションメニュー）
- **売上伝票ボタン**
  - アイコン: FileText
  - テキスト: "売上伝票"
  - アクティブ時: 青色背景（bg-blue-600）
  - 非アクティブ時: グレー300文字色、ホバー時グレー700背景

- **仕入伝票ボタン**
  - アイコン: ShoppingCart
  - テキスト: "仕入伝票"
  - アクティブ時: 緑色背景（bg-green-600）
  - 非アクティブ時: グレー300文字色、ホバー時グレー700背景

#### 3.1.3 右側エリア
- **最終更新日**: 現在日付表示（グレー400、16px）
- **ユーザープロフィールボタン**
  - アイコン: UserCircle2
  - ユーザー名: "山田 太郎"
  - クリック時: プロフィールモーダル表示

### 3.2 メインコンテンツエリア
- **最大幅**: 1280px（max-w-7xl）
- **パディング**: 上下24px、左右24px（sm以上）
- **背景色**: グレー50

---

## 4. 売上伝票一覧画面 (`/sales`)

### 4.1 画面レイアウト
- **左側**: 伝票一覧テーブル（flex-1）
- **右側**: 集計パネル（幅320px固定）

### 4.2 ページヘッダー
- **アイコン**: FileText（青色、32px）
- **タイトル**: "売上伝票一覧"（24px、太字）
- **新規作成ボタン**: 青色背景、Plusアイコン付き

### 4.3 検索・フィルターエリア
#### 4.3.1 検索入力
- **プレースホルダー**: "得意先名、製番で検索"
- **アイコン**: FileText（左側配置）
- **クリアボタン**: 赤色背景、Xアイコン付き

#### 4.3.2 日付範囲フィルター
- **開始日**: date型入力フィールド
- **終了日**: date型入力フィールド
- **区切り文字**: "～"

### 4.4 テーブル設定エリア
- **表示件数選択**: 10件/20件/50件
- **CSVエクスポートボタン**: Downloadアイコン付き

### 4.5 売上伝票テーブル
#### 4.5.1 カラム構成
| カラム名 | 幅 | 内容 | 備考 |
|---------|----|----|-----|
| 請求番号 | 100px | SI000001形式 | FileTextアイコン付き、青色 |
| 得意先 | 300px | 得意先名 | 太字表示 |
| 請求日 | 100px | yyyy/MM/dd形式 | 等幅フォント |
| 明細数 | 80px | X件 | 青色バッジ表示 |
| 合計金額 | 120px | ¥X,XXX,XXX | 等幅フォント、右寄せ |
| 担当者 | 120px | 担当者名 | - |
| 部門 | 160px | 部門名 | - |

#### 4.5.2 テーブル機能
- **行クリック**: 詳細画面へ遷移
- **ホバー効果**: 背景色変更（グレー50）
- **ページネーション**: 下部に表示

### 4.6 集計パネル（右側）
#### 4.6.1 月次推移グラフ
- **タイトル**: "月次推移"
- **グラフタイプ**: 折れ線グラフ
- **データ期間**: 過去6ヶ月
- **Y軸**: 金額（万円単位）
- **色**: 青色（#3B82F6）

#### 4.6.2 集計情報
- **期間選択**: 全期間/月別/年別
- **年月選択**: 期間選択に応じて表示

**集計項目**:
1. **合計金額**: 青色背景（bg-blue-50）、TrendingUpアイコン
2. **平均金額**: インディゴ色背景（bg-indigo-50）、TrendingUpアイコン
3. **得意先数**: 紫色背景（bg-purple-50）、Usersアイコン

#### 4.6.3 得意先別金額トップ3
- **順位表示**: 1. 2. 3.
- **得意先名**: 最大150px幅で切り詰め
- **金額**: 右寄せ表示

---

## 5. 売上伝票登録・編集画面 (`/sales/new`, `/sales/:id`)

### 5.1 ページヘッダー
- **アイコン**: ScrollText（青色、24px）
- **タイトル**: "売上伝票登録" または "売上伝票詳細"
- **戻るボタン**: ArrowLeftアイコン付き
- **編集/保存ボタン**: 編集時のみ表示、青色背景

### 5.2 基本情報セクション
#### 5.2.1 レイアウト
- **グリッド**: 12カラムレイアウト
- **背景**: 白色、影付きカード

#### 5.2.2 入力フィールド
| フィールド名 | 幅 | 必須 | 備考 |
|------------|----|----|-----|
| 請求番号 | 2カラム | - | 自動採番、読み取り専用 |
| 得意先 | 8カラム | ○ | 検索可能セレクト |
| 税区分 | 2カラム | - | 得意先選択時自動設定 |
| 請求日 | 2カラム | ○ | date型 |
| 担当者 | 6カラム | ○ | 検索可能セレクト |
| 担当部門 | 4カラム | - | 担当者選択時自動設定 |

### 5.3 明細情報セクション
#### 5.3.1 セクションヘッダー
- **タイトル**: "明細情報"
- **明細追加ボタン**: 青色背景、Plusアイコン付き

#### 5.3.2 明細テーブル
| カラム名 | 幅 | 内容 | 備考 |
|---------|----|----|-----|
| 製番 | 220px | TK25X999形式 | JobPub取得ボタン付き |
| 品名 | 可変 | 品名 | テキストエリア |
| 数量 | 固定 | 数量+単位 | 数値入力+単位選択 |
| 単価 | 固定 | 単価 | 数値入力、右寄せ |
| 金額 | 固定 | 金額 | 自動計算、右寄せ |
| 操作 | 80px | 編集/削除 | アイコンボタン |

#### 5.3.3 明細機能
- **編集モード**: 行単位で編集/保存
- **削除確認**: モーダルダイアログ表示
- **JobPub取得**: 製番8桁入力時に有効化

#### 5.3.4 合計行
- **位置**: テーブル下部（tfoot）
- **表示**: "合計金額" + 金額
- **背景**: グレー50

---

## 6. 仕入伝票一覧画面 (`/purchases`)

### 6.1 画面レイアウト
売上伝票一覧画面と同様の構成、色テーマが緑色

### 6.2 ページヘッダー
- **アイコン**: ShoppingCart（緑色、32px）
- **タイトル**: "仕入伝票一覧"
- **新規作成ボタン**: 緑色背景

### 6.3 検索・フィルターエリア
- **検索プレースホルダー**: "仕入先名で検索"
- **アイコン**: ShoppingCart

### 6.4 仕入伝票テーブル
#### 6.4.1 カラム構成
| カラム名 | 幅 | 内容 | 備考 |
|---------|----|----|-----|
| 仕入先 | 300px | 仕入先名 | 太字表示 |
| 日付 | 100px | yyyy/MM/dd形式 | 等幅フォント |
| 明細数 | 80px | X件 | 緑色バッジ表示 |
| 合計金額 | 120px | ¥X,XXX,XXX | 等幅フォント、右寄せ |
| 担当者 | 120px | 担当者名 | - |
| 部門 | 160px | 部門名 | - |

### 6.5 集計パネル（緑色テーマ）
- **グラフ色**: 緑色（#10B981）
- **集計項目背景**: 緑色系統
- **仕入先別金額トップ3**: 仕入先名表示

---

## 7. 仕入伝票登録・編集画面 (`/purchases/new`, `/purchases/:id`)

### 7.1 ページヘッダー
- **アイコン**: ShoppingCart（緑色、24px）
- **タイトル**: "仕入伝票登録" または "仕入伝票詳細"
- **編集/保存ボタン**: 緑色背景

### 7.2 基本情報セクション
#### 7.2.1 入力フィールド
| フィールド名 | 幅 | 必須 | 備考 |
|------------|----|----|-----|
| 発注番号 | 2カラム | ○ | 7桁数字 |
| 仕入先 | 8カラム | ○ | 検索可能セレクト |
| 納品書番号 | 2カラム | ○ | DN-0000形式 |
| 日付 | 2カラム | ○ | date型 |
| 担当者 | 6カラム | ○ | 検索可能セレクト |
| 担当部門 | 4カラム | - | 担当者選択時自動設定 |

### 7.3 明細情報セクション
#### 7.3.1 セクションヘッダー
- **CREPOS取得ボタン**: 発注番号7桁入力時に有効化
- **明細追加ボタン**: 緑色背景

#### 7.3.2 明細テーブル
| カラム名 | 幅 | 内容 | 備考 |
|---------|----|----|-----|
| 製番 | 固定 | TK25X999形式 | 8桁英数字 |
| 品名 | 可変 | 品名 | テキストエリア |
| 作業コード | 固定 | 作業コード | セレクトボックス |
| 数量 | 固定 | 数量+単位 | 数値入力+単位選択 |
| 単価 | 固定 | 単価 | 数値入力、右寄せ |
| 金額 | 固定 | 金額 | 自動計算、右寄せ |
| 操作 | 80px | 編集/削除 | アイコンボタン |

#### 7.3.3 作業コード一覧
- DTP (70000)
- 翻訳 (20000)
- 編集 (30000)
- 原稿作成 (10000)
- イラスト (50000)
- デザイン (40000)
- その他多数

---

## 8. 共通コンポーネント

### 8.1 検索可能セレクト (SearchableSelect)
- **機能**: タイプ入力による絞り込み
- **UI**: Headless UI Combobox使用
- **色テーマ**: 青色/緑色対応

### 8.2 ページネーション (Pagination)
- **デスクトップ**: ページ番号表示
- **モバイル**: 前へ/次へボタンのみ
- **省略表示**: 7ページ超過時

### 8.3 削除確認ダイアログ (DeleteConfirmationDialog)
- **背景**: 半透明オーバーレイ
- **ボタン**: キャンセル/削除
- **削除ボタン**: 赤色背景

### 8.4 ユーザープロフィールモーダル (UserProfileModal)
- **ヘッダー**: 青色グラデーション背景
- **プロフィール画像**: 円形、編集ボタン付き
- **情報表示**: メール、部門、電話番号
- **設定メニュー**: プロフィール編集、パスワード変更等

### 8.5 計算機 (Calculator)
- **レイアウト**: 4×4ボタングリッド
- **機能**: 基本四則演算
- **デザイン**: グラデーションボタン

---

## 9. レスポンシブ対応

### 9.1 ブレークポイント
- **sm**: 640px以上
- **md**: 768px以上
- **lg**: 1024px以上
- **xl**: 1280px以上

### 9.2 モバイル対応
- **ナビゲーション**: 縦積み表示
- **テーブル**: 横スクロール対応
- **ページネーション**: 簡易表示
- **集計パネル**: 下部配置

---

## 10. カラーパレット

### 10.1 売上伝票（青色テーマ）
- **プライマリ**: #3B82F6 (blue-500)
- **背景**: #EFF6FF (blue-50)
- **ボーダー**: #DBEAFE (blue-100)

### 10.2 仕入伝票（緑色テーマ）
- **プライマリ**: #10B981 (emerald-500)
- **背景**: #ECFDF5 (emerald-50)
- **ボーダー**: #D1FAE5 (emerald-100)

### 10.3 共通色
- **グレー**: #F9FAFB (gray-50) - #111827 (gray-900)
- **エラー**: #EF4444 (red-500)
- **警告**: #F59E0B (amber-500)

---

## 11. アニメーション・インタラクション

### 11.1 ホバー効果
- **ボタン**: 上方向移動 + 影強化
- **テーブル行**: 背景色変更
- **カード**: 影強化

### 11.2 トランジション
- **色変更**: 0.2秒
- **変形**: 0.2秒
- **フェードイン**: 0.3秒

### 11.3 フォーカス状態
- **入力フィールド**: 枠線色変更 + 影表示
- **ボタン**: アウトライン表示

---

## 12. アクセシビリティ

### 12.1 キーボード操作
- **Tab順序**: 論理的な順序
- **Enter/Space**: ボタン操作
- **Escape**: モーダル閉じる

### 12.2 スクリーンリーダー対応
- **aria-label**: 適切なラベル設定
- **role属性**: 適切な役割定義
- **alt属性**: 画像の代替テキスト

### 12.3 色覚対応
- **コントラスト比**: WCAG AA準拠
- **色以外の情報**: アイコン併用

---

## 13. パフォーマンス

### 13.1 最適化
- **遅延読み込み**: 大きなコンポーネント
- **メモ化**: 計算結果キャッシュ
- **仮想化**: 大量データ表示

### 13.2 読み込み状態
- **スケルトン**: データ読み込み中
- **スピナー**: 処理実行中
- **プログレスバー**: 長時間処理

---

この画面定義書は、現在のEntry Core Billingシステムの実装に基づいて作成されています。各画面の詳細な仕様、コンポーネントの動作、デザインガイドラインを網羅しており、開発・保守・改善の際の参考資料として活用できます。